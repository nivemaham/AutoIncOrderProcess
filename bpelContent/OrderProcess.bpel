<!-- OrderProcess BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Sun Jun 21 08:44:50 EEST 2015 -->
<bpel:process name="OrderProcess"
         targetNamespace="http://order.autoinc.com"
         suppressJoinFailure="yes"
         xmlns:tns="http://order.autoinc.com"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:ns0="http://www.example.org/WareHouseService/" xmlns:ns1="http://supplier.autoinc.com/SupplyService/" xmlns:ns2="http://servicepayment.autoinc.com/PaymentService/" xmlns:xsd="http://www.example.org/PaymentServiceSchema" xmlns:ns3="http://www.w3.org/2001/XMLSchema" xmlns:ns4="http://check.autoinc.com">

    <!-- Import the client WSDL -->
    <bpel:import namespace="http://check.autoinc.com" location="AutoIncCheckAvailabilityProcessArtifacts.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://www.example.org/PaymentServiceSchema" location="PaymentServiceSchema.xsd" importType="http://www.w3.org/2001/XMLSchema"></bpel:import>
    <bpel:import namespace="http://servicepayment.autoinc.com/PaymentService/" location="PaymentService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://supplier.autoinc.com/SupplyService/" location="SupplyService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://www.example.org/WareHouseService/" location="WareHouseService.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://process.order.autoinc.com/AutoIncOrderProcess/" location="AutoIncOrderProcess.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import location="OrderProcessArtifacts.wsdl" namespace="http://order.autoinc.com" 
	        importType="http://schemas.xmlsoap.org/wsdl/" />
         
    <!-- ================================================================= -->         
    <!-- PARTNERLINKS                                                      -->
    <!-- List of services participating in this BPEL process               -->
    <!-- ================================================================= -->         
    <bpel:partnerLinks>
        <!-- The 'client' role represents the requester of this service. -->
        <bpel:partnerLink name="client"
                     partnerLinkType="tns:OrderProcess"
                     myRole="OrderProcessProvider"
                     />
        <bpel:partnerLink name="AutoIncfactoryPL" partnerLinkType="tns:FactoryPLT" partnerRole="Factory"></bpel:partnerLink>
        <bpel:partnerLink name="WareHousePL" partnerLinkType="tns:WareHousePLT" partnerRole="warehouse"></bpel:partnerLink>
        <bpel:partnerLink name="SupplyPL" partnerLinkType="tns:SupplyPLT" partnerRole="supplier"></bpel:partnerLink>
        <bpel:partnerLink name="PaymentProviderPL" partnerLinkType="tns:PaymentProviderPLT" partnerRole="paymentProvider"></bpel:partnerLink>
        <bpel:partnerLink name="AvailabilityProviderPL" partnerLinkType="tns:AvailabilityPLT" partnerRole="availabilitychecker"></bpel:partnerLink>
    </bpel:partnerLinks>
  
    <!-- ================================================================= -->         
    <!-- VARIABLES                                                         -->
    <!-- List of messages and XML documents used within this BPEL process  -->
    <!-- ================================================================= -->         
    <bpel:variables>
        <!-- Reference to the message passed as input during initiation -->
        <bpel:variable name="input"
                  messageType="tns:OrderProcessRequestMessage"/>
                  
        <!-- 
          Reference to the message that will be returned to the requester
          -->
        <bpel:variable name="output"
                  messageType="tns:OrderProcessResponseMessage"/>
        <bpel:variable name="AutoIncfactoryPLResponse" messageType="ns:findCheapestSupplierResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLRequest" messageType="ns:findCheapestSupplierRequest"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLResponse1" messageType="ns:showtotalCostResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLRequest1" messageType="ns:showtotalCostRequest"></bpel:variable>
        <bpel:variable name="clientRequest" messageType="tns:confirmOrderRequest"></bpel:variable>
        <bpel:variable name="clientResponse" messageType="tns:confirmOrderResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLResponse2" messageType="ns:createOrderResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLRequest2" messageType="ns:createOrderRequest"></bpel:variable>
        <bpel:variable name="WareHousePLResponse" messageType="ns0:reserveProductResponse"></bpel:variable>
        <bpel:variable name="WareHousePLRequest" messageType="ns0:reserveProductRequest"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLResponse3" messageType="ns:registerCustomerResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLRequest3" messageType="ns:registerCustomerRequest"></bpel:variable>
        <bpel:variable name="SupplyPLResponse" messageType="ns1:confirmTransportationResponse"></bpel:variable>
        <bpel:variable name="SupplyPLRequest" messageType="ns1:confirmTransportationRequest"></bpel:variable>
        <bpel:variable name="PaymentProviderPLResponse" messageType="ns2:confirmPaymentResponse"></bpel:variable>
        <bpel:variable name="PaymentProviderPLRequest" messageType="ns2:confirmPaymentRequest"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLResponse4" messageType="ns:updateOrderStatusResponse"></bpel:variable>
        <bpel:variable name="AutoIncfactoryPLRequest4" messageType="ns:updateOrderStatusRequest"></bpel:variable>
        <bpel:variable name="clientRequest1" messageType="tns:checkAvailabilityRequest"></bpel:variable>
        <bpel:variable name="clientResponse1" messageType="tns:checkAvailabilityResponse"></bpel:variable>
        <bpel:variable name="AvailabilityProviderPLResponse" messageType="ns4:AutoIncCheckAvailabilityProcessResponseMessage"></bpel:variable>
        <bpel:variable name="AvailabilityProviderPLRequest" messageType="ns4:AutoIncCheckAvailabilityProcessRequestMessage"></bpel:variable>
        <bpel:variable name="SupplyPLResponse1" messageType="ns1:cancelTransportationResponse"></bpel:variable>
        <bpel:variable name="SupplyPLRequest1" messageType="ns1:cancelTransportationRequest"></bpel:variable>
        <bpel:variable name="WareHousePLResponse1" messageType="ns0:freeProductResponse"></bpel:variable>
        <bpel:variable name="WareHousePLRequest1" messageType="ns0:freeProductRequest"></bpel:variable>
    </bpel:variables>

    <!-- ================================================================= -->         
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->         
    <bpel:correlationSets>
        <bpel:correlationSet name="ordercorrelateset" properties="tns:orderid"></bpel:correlationSet>
    </bpel:correlationSets>
    <bpel:sequence name="main">
        
        <!-- Receive input from requester. 
             Note: This maps to operation defined in OrderProcess.wsdl 
             -->
        <bpel:pick name="Pick" createInstance="yes">
            <bpel:onMessage partnerLink="client" operation="process" portType="tns:OrderProcess" variable="input">
                <bpel:sequence>
                    <bpel:assign validate="no" name="AssignToFindCheapestSupplier"><bpel:copy>
                <bpel:from><bpel:literal><tns:findCheapestSupplier xmlns:tns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <preferencess>preferencess</preferencess>
  <customerid>customerid</customerid>
</tns:findCheapestSupplier>
</bpel:literal></bpel:from>
                <bpel:to variable="AutoIncfactoryPLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:preference]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[preferencess]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[customerid]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        
                </bpel:assign>
                    <bpel:invoke name="FindCheapestSupplier" partnerLink="AutoIncfactoryPL" operation="findCheapestSupplier" portType="ns:AutoIncOrderProcess" inputVariable="AutoIncfactoryPLRequest" outputVariable="AutoIncfactoryPLResponse"></bpel:invoke>
                    <bpel:assign validate="no" name="AssignCheapestSupplier">
            
            
            
            <bpel:copy>
                <bpel:from><bpel:literal><tns:showtotalCost xmlns:tns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <productId>0</productId>
  <transportationcost>0.0</transportationcost>
  <quantity>0</quantity>
  <customerid>customerid</customerid>
</tns:showtotalCost>
</bpel:literal></bpel:from>
                <bpel:to variable="AutoIncfactoryPLRequest1" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="AutoIncfactoryPLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[transportationCost]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[transportationcost]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:productId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[productId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:quantity]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[quantity]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="AutoIncfactoryPLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[customerid]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="AutoIncfactoryPLRequest1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[customerid]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        
                    </bpel:assign>
                    <bpel:invoke name="CalculatetotalCost" partnerLink="AutoIncfactoryPL" operation="showtotalCost" portType="ns:AutoIncOrderProcess" inputVariable="AutoIncfactoryPLRequest1" outputVariable="AutoIncfactoryPLResponse1"></bpel:invoke>
                    <bpel:assign validate="no" name="AssignTotalCost"><bpel:copy>
                <bpel:from><bpel:literal><tns:OrderProcessResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:totalcost>0.0</tns:totalcost>
  <tns:supplierid>0</tns:supplierid>
  <tns:customerid>tns:customerid</tns:customerid>
</tns:OrderProcessResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="output" part="payload"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="AutoIncfactoryPLResponse1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[customerid]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:customerid]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="AutoIncfactoryPLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[supplierId]]></bpel:query>
                </bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplierid]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="AutoIncfactoryPLResponse1">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[totalCost]]></bpel:query>
                </bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:totalcost]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        
                    </bpel:assign>
                    <bpel:reply name="replyOutput" partnerLink="client" portType="tns:OrderProcess" operation="process" variable="output" />
                </bpel:sequence>
            </bpel:onMessage>
            
            <bpel:onMessage partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientRequest">
                <bpel:sequence>
                    <bpel:assign validate="no" name="AssignToCreateOrder">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:createOrder xmlns:tns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <customerId>0</customerId>
  <productId>0</productId>
  <supplierId>0</supplierId>
  <totalCost>0.0</totalCost>
  <quantity>0</quantity>
</tns:createOrder>
</bpel:literal></bpel:from>
                            <bpel:to variable="AutoIncfactoryPLRequest2" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[customerId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplierid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[supplierId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[productId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:totalCost]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[totalCost]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:quantity]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[quantity]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeCreateOrder" partnerLink="AutoIncfactoryPL" operation="createOrder" portType="ns:AutoIncOrderProcess" inputVariable="AutoIncfactoryPLRequest2" outputVariable="AutoIncfactoryPLResponse2">
                    <bpel:catch faultName="ns:createorderfault"><bpel:sequence>
                                <bpel:assign validate="no" name="AssignToFault">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:confirmOrderResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:orderid>0</tns:orderid>
  <tns:orderstatus>tns:orderstatus</tns:orderstatus>
  <tns:supplier>0</tns:supplier>
  <tns:customerid>0</tns:customerid>
  <tns:productid>0</tns:productid>
  <tns:productReserved>true</tns:productReserved>
  <tns:isTranportConfirmed>tns:isTranportConfirmed</tns:isTranportConfirmed>
  <tns:isPaymentConfirmed>tns:isPaymentConfirmed</tns:isPaymentConfirmed>
  <tns:invoicenumber>tns:invoicenumber</tns:invoicenumber>
</tns:confirmOrderResponse>
</bpel:literal></bpel:from>
                                        <bpel:to variable="clientResponse" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">0</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">NOT_CREATED</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderstatus]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplierid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplier]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productReserved]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isTranportConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isPaymentConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">NOT_AVAILABLE</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:invoicenumber]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                </bpel:assign>
                                <bpel:reply name="Replycreationfault" partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientResponse"></bpel:reply>
                                <bpel:exit name="Exit1"></bpel:exit>
                            </bpel:sequence></bpel:catch></bpel:invoke>
                    
                    
                    
                    <bpel:assign validate="no" name="AssignToReserveProduct">
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:reserveProduct xmlns:tns="http://www.example.org/WareHouseService/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <productId>0</productId>
  <warehouseid>0</warehouseid>
  <quantity>0</quantity>
  <orderid>orderid</orderid>
</tns:reserveProduct>
</bpel:literal></bpel:from>
                            <bpel:to variable="WareHousePLRequest" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="WareHousePLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[productId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:quantity]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="WareHousePLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[quantity]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal xml:space="preserve">1</bpel:literal>
                            </bpel:from>
                            <bpel:to part="parameters" variable="WareHousePLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[warehouseid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="WareHousePLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeReserveProduct" partnerLink="WareHousePL" operation="reserveProduct" portType="ns0:WareHouseService" inputVariable="WareHousePLRequest" outputVariable="WareHousePLResponse">
                        <bpel:correlations>
                            <bpel:correlation set="ordercorrelateset" initiate="yes" pattern="response"></bpel:correlation>
                        </bpel:correlations>
                    <bpel:catch faultName="ns0:reserveproductfault"><bpel:sequence>
                                <bpel:assign validate="no" name="AssignToReportFault">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:confirmOrderResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:orderid>0</tns:orderid>
  <tns:orderstatus>tns:orderstatus</tns:orderstatus>
  <tns:supplier>0</tns:supplier>
  <tns:customerid>0</tns:customerid>
  <tns:productid>0</tns:productid>
  <tns:productReserved>true</tns:productReserved>
  <tns:isTranportConfirmed>tns:isTranportConfirmed</tns:isTranportConfirmed>
  <tns:isPaymentConfirmed>tns:isPaymentConfirmed</tns:isPaymentConfirmed>
  <tns:invoicenumber>tns:invoicenumber</tns:invoicenumber>
</tns:confirmOrderResponse>
</bpel:literal></bpel:from>
                                        <bpel:to variable="clientResponse" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderStatus]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderstatus]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplierid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplier]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productReserved]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isTranportConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isPaymentConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">NOT_AVAILABLE</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:invoicenumber]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                </bpel:assign>
                                <bpel:reply name="ReplyReservationFailure" partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientResponse"></bpel:reply>
                                <bpel:exit name="ExitOrder"></bpel:exit>
                            </bpel:sequence></bpel:catch></bpel:invoke>
                    <bpel:assign validate="no" name="AssignToverifySupply">
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:confirmTransportation xmlns:tns="http://supplier.autoinc.com/SupplyService/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <orderId>0</orderId>
  <orderToken>orderToken</orderToken>
</tns:confirmTransportation>
</bpel:literal></bpel:from>
                            <bpel:to variable="SupplyPLRequest" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[orderId]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="SupplyPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[orderId]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="WareHousePLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="SupplyPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderToken]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeConfirmSupply" partnerLink="SupplyPL" operation="confirmTransportation" portType="ns1:SupplyService" inputVariable="SupplyPLRequest" outputVariable="SupplyPLResponse">
                        <bpel:correlations>
                            <bpel:correlation set="ordercorrelateset" initiate="no" pattern="response"></bpel:correlation>
                        </bpel:correlations>
                    <bpel:catch><bpel:sequence>
                                
                                <bpel:assign validate="no" name="Assign">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:freeProduct xmlns:tns="http://www.example.org/WareHouseService/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <productId>0</productId>
  <orderid>orderid</orderid>
  <warehouseid>0</warehouseid>
  <quantity>0</quantity>
</tns:freeProduct>
</bpel:literal></bpel:from>
                                        <bpel:to variable="WareHousePLRequest1" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:confirmOrderResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:orderid>0</tns:orderid>
  <tns:orderstatus>tns:orderstatus</tns:orderstatus>
  <tns:supplier>0</tns:supplier>
  <tns:customerid>0</tns:customerid>
  <tns:productid>0</tns:productid>
  <tns:productReserved>true</tns:productReserved>
  <tns:isTranportConfirmed>tns:isTranportConfirmed</tns:isTranportConfirmed>
  <tns:isPaymentConfirmed>tns:isPaymentConfirmed</tns:isPaymentConfirmed>
  <tns:invoicenumber>tns:invoicenumber</tns:invoicenumber>
</tns:confirmOrderResponse>
</bpel:literal></bpel:from>
                                        <bpel:to variable="clientResponse" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderStatus]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderstatus]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[supplier]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplier]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productReserved]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isTranportConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isPaymentConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">NOT_AVAILABLE</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:invoicenumber]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[productId]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[warehouseid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[tns:quantity]]>
                                            </bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[quantity]]>
                                            </bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                </bpel:assign>
                                <bpel:invoke name="FreeProducts" partnerLink="WareHousePL" operation="freeProduct" portType="ns0:WareHouseService" inputVariable="WareHousePLRequest1" outputVariable="WareHousePLResponse1"></bpel:invoke>
                                <bpel:reply name="ReplyFaultMsg" partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientResponse"></bpel:reply>
                                <bpel:exit name="ExitFromSupplier"></bpel:exit>
                            </bpel:sequence></bpel:catch></bpel:invoke>
                    
                    
                    <bpel:assign validate="no" name="AssignToPayment">
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:PaymentDetailInput xmlns:tns="http://www.example.org/PaymentServiceSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:customerId>0</tns:customerId>
  <tns:totalCost>0.0</tns:totalCost>
  <tns:paymentMethod>tns:paymentMethod</tns:paymentMethod>
  <tns:cardNumber>tns:cardNumber</tns:cardNumber>
  <tns:orderid>tns:orderid</tns:orderid>
</tns:PaymentDetailInput>
</bpel:literal></bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                             <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[xsd:customerId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:totalCost]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[xsd:totalCost]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:cardnumber]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[xsd:cardNumber]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:paymentmethod]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[xsd:paymentMethod]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="PaymentProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[xsd:orderid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokePayment" partnerLink="PaymentProviderPL" operation="confirmPayment" portType="ns2:PaymentService" inputVariable="PaymentProviderPLRequest" outputVariable="PaymentProviderPLResponse">
                        <bpel:correlations>
                            <bpel:correlation set="ordercorrelateset" initiate="no" pattern="response"></bpel:correlation>
                        </bpel:correlations>
                    <bpel:catch faultName="ns2:paymentfault"><bpel:sequence><bpel:compensate></bpel:compensate><bpel:assign validate="no" name="AssignToCompensate">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:updateOrderStatus xmlns:tns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <orderId>0</orderId>
  <orderToken>orderToken</orderToken>
</tns:updateOrderStatus>
</bpel:literal></bpel:from>
                                        <bpel:to variable="AutoIncfactoryPLRequest4" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:freeProduct xmlns:tns="http://www.example.org/WareHouseService/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <productId>0</productId>
  <orderid>orderid</orderid>
  <warehouseid>0</warehouseid>
  <quantity>0</quantity>
</tns:freeProduct>
</bpel:literal></bpel:from>
                                        <bpel:to variable="WareHousePLRequest1" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:cancelTransportation xmlns:tns="http://supplier.autoinc.com/SupplyService/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <orderId>0</orderId>
  <orderToken>orderToken</orderToken>
</tns:cancelTransportation>
</bpel:literal></bpel:from>
                                        <bpel:to variable="SupplyPLRequest1" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="SupplyPLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[orderId]]>
                                            </bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[orderid]]>
                                            </bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[productId]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:quantity]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[quantity]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="WareHousePLRequest1">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[warehouseid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="AutoIncfactoryPLRequest4">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[orderId]]>
                                            </bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="AutoIncfactoryPLRequest4">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderToken]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                </bpel:assign><bpel:invoke name="cancleTransportation" partnerLink="SupplyPL" operation="cancelTransportation" portType="ns1:SupplyService" inputVariable="SupplyPLRequest1" outputVariable="SupplyPLResponse1"></bpel:invoke><bpel:invoke name="freeReservedProducts" partnerLink="WareHousePL" operation="freeProduct" portType="ns0:WareHouseService" inputVariable="WareHousePLRequest1" outputVariable="WareHousePLResponse1"></bpel:invoke><bpel:invoke name="updateOrderStatus" partnerLink="AutoIncfactoryPL" operation="updateOrderStatus" portType="ns:AutoIncOrderProcess" inputVariable="AutoIncfactoryPLRequest4" outputVariable="AutoIncfactoryPLResponse4"></bpel:invoke><bpel:assign validate="no" name="AssignCompensated">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal><tns:confirmOrderResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:orderid>0</tns:orderid>
  <tns:orderstatus>tns:orderstatus</tns:orderstatus>
  <tns:supplier>0</tns:supplier>
  <tns:customerid>0</tns:customerid>
  <tns:productid>0</tns:productid>
  <tns:productReserved>true</tns:productReserved>
  <tns:isTranportConfirmed>tns:isTranportConfirmed</tns:isTranportConfirmed>
  <tns:isPaymentConfirmed>tns:isPaymentConfirmed</tns:isPaymentConfirmed>
  <tns:invoicenumber>tns:invoicenumber</tns:invoicenumber>
</tns:confirmOrderResponse>
</bpel:literal></bpel:from>
                                        <bpel:to variable="clientResponse" part="parameters"></bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="AutoIncfactoryPLResponse4">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[currentStatus]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderstatus]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplierid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                <![CDATA[tns:supplier]]>
                                            </bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from part="parameters" variable="clientRequest">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productReserved]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isTranportConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">false</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isPaymentConfirmed]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal xml:space="preserve">not available
</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="parameters" variable="clientResponse">
                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:invoicenumber]]></bpel:query>
                                        </bpel:to>
                                    </bpel:copy>
                                </bpel:assign><bpel:reply name="Reply" partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientResponse"></bpel:reply><bpel:exit name="Exit"></bpel:exit></bpel:sequence></bpel:catch></bpel:invoke>
                    <bpel:assign validate="no" name="AssignToUpdateStatus">
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:updateOrderStatus xmlns:tns="http://process.order.autoinc.com/AutoIncOrderProcess/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <orderId>0</orderId>
  <orderToken>orderToken</orderToken>
</tns:updateOrderStatus>
</bpel:literal></bpel:from>
                            <bpel:to variable="AutoIncfactoryPLRequest4" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest4">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="AutoIncfactoryPLRequest4">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderToken]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeUpdateStatus" partnerLink="AutoIncfactoryPL" operation="updateOrderStatus" portType="ns:AutoIncOrderProcess" inputVariable="AutoIncfactoryPLRequest4" outputVariable="AutoIncfactoryPLResponse4"></bpel:invoke>
                    
                    <bpel:assign validate="no" name="AssignFromCreateOrder">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    
                        
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:confirmOrderResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:orderid>0</tns:orderid>
  <tns:orderstatus>tns:orderstatus</tns:orderstatus>
  <tns:supplier>0</tns:supplier>
  <tns:customerid>0</tns:customerid>
  <tns:productid>0</tns:productid>
  <tns:productReserved>true</tns:productReserved>
  <tns:isTranportConfirmed>tns:isTranportConfirmed</tns:isTranportConfirmed>
  <tns:isPaymentConfirmed>tns:isPaymentConfirmed</tns:isPaymentConfirmed>
  <tns:invoicenumber>tns:invoicenumber</tns:invoicenumber>
</tns:confirmOrderResponse>
</bpel:literal></bpel:from>
                            <bpel:to variable="clientResponse" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[orderId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse4">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[currentStatus]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:orderstatus]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[supplier]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:supplier]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:customerid]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:customerid]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="AutoIncfactoryPLResponse2">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[product/productid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="WareHousePLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[isReserved]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productReserved]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="SupplyPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[isTransportationAvailable]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isTranportConfirmed]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="PaymentProviderPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[xsd:paymentStatus]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:isPaymentConfirmed]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="PaymentProviderPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[xsd:paymentinvoice]]>
                                </bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:invoicenumber]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    
                    <bpel:reply name="ReplyOrder" partnerLink="client" operation="confirmOrder" portType="tns:OrderProcess" variable="clientResponse"></bpel:reply>
                </bpel:sequence>
            </bpel:onMessage>
            <bpel:onMessage partnerLink="client" operation="checkAvailability" portType="tns:OrderProcess" variable="clientRequest1">
                <bpel:sequence>
                    <bpel:assign validate="no" name="AssignToCheckAvailability">
                        
                        
                        
                        
                        
                        
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:AutoIncCheckAvailabilityProcessRequest xmlns:tns="http://check.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:productId>0</tns:productId>
  <tns:quantity>0</tns:quantity>
  <tns:customerid>tns:customerid</tns:customerid>
</tns:AutoIncCheckAvailabilityProcessRequest>
</bpel:literal></bpel:from>
                            <bpel:to variable="AvailabilityProviderPLRequest" part="payload"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:productId]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="payload" variable="AvailabilityProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:productId]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:quantity]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="payload" variable="AvailabilityProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:quantity]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="clientRequest1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="payload" variable="AvailabilityProviderPLRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:customerid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="InvokeCheckAvailability" partnerLink="AvailabilityProviderPL" operation="process" portType="ns4:AutoIncCheckAvailabilityProcess" inputVariable="AvailabilityProviderPLRequest" outputVariable="AvailabilityProviderPLResponse"></bpel:invoke>
                    <bpel:assign validate="no" name="AssignFromcheckAvailability">
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:checkAvailabilityResponse xmlns:tns="http://order.autoinc.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:isAvailable>true</tns:isAvailable>
  <tns:availabilityType>tns:availabilityType</tns:availabilityType>
  <tns:customerid>tns:customerid</tns:customerid>
</tns:checkAvailabilityResponse>
</bpel:literal></bpel:from>
                            <bpel:to variable="clientResponse1" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="payload" variable="AvailabilityProviderPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:isAvailable]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:isAvailable]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="payload" variable="AvailabilityProviderPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:availabilityType]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:availabilityType]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="payload" variable="AvailabilityProviderPLResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:customerid]]></bpel:query>
                            </bpel:from>
                            <bpel:to part="parameters" variable="clientResponse1">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:customerid]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:reply name="ReplyAvailability" partnerLink="client" operation="checkAvailability" portType="tns:OrderProcess" variable="clientResponse1"></bpel:reply>
                    
                </bpel:sequence>
            </bpel:onMessage>
        </bpel:pick>
        
        
        <!-- Generate reply to synchronous request -->
        
        
    </bpel:sequence>
</bpel:process>

